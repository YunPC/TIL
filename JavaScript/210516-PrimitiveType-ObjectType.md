# 원시값과 객체의 비교

원시 타입과 객체 타입은 3가지 차이점을 가지고 있다.

- 원시 타입은 불변성이지만 객체 타입의 값은 바뀔 수 있다.
- 원시값을 변수에 할당하면 변수에 실제 값이 저장된다. 객체를 변수에 할당한 경우 참조값이 저장된다.
- 원시값을 갖는 변수를 다른 변수에 할당하면 원시값이 복사되어 전달되고 객체의 경우 참조값을 복사하여 전달한다. 앞의 경우를 값에 의한 전달(pass by value) 그 뒤의 경우를 참조에 의한 전달(pass by reference)라 한다.

1. 원시값

- 변경 불가능한 값

원시 타입의 값은 변할 수 없다. 변경 불가능 하단 말은 변수값의 변경이 불가능한 것이 아니라 원시값 자체의 변경이 불가능하단 것이다. 변수는 재할당을 통해 변수 값을 변경할 수 있다.

변수의 상대 개념인 상수는 재할당이 금지된 변수이다.

원시값은 변경이 불가능한 읽기 전용 값이기 때문에 데이터의 신뢰성을 보장한다.

따라서 변수에 원시값을 재할당 하는 경우 새로운 메모리 공간이 할당되고, 변수가 가리키는 값을 새로운 메모리 공간으로 바꾼다. 원시값을 갖는 변수는 재할당 말고 값을 변경할 수 있는 방법이 존재하지 않는다.

- 문자열과 불변성

원시값을 저장하기 위한 메모리 크기는 숫자와 문자열 이외에 딱히 정해진 것이 없다. 

문자열은 다른 원시값과 비교할 때 가변적인 메모리 공간을 확보한다는 특징이 있다.

자바스크립트는 다른 언어와 달리 원시 타입인 문자열을 제공한다. 따라서 문자열의 수정이 불가능하다.

문자열은 유사 배열 객체(array-like object)이다. 인덱스를 통해 프로퍼티 값에 접근할 수 있고 length를 갖기 때문이다. 또한 for문을 통해 안에 있는 값들을 순회할 수 있다. 

- 값에 의한 전달

한 변수를 다른 변수에 할당하면 원시타입의 경우 같은 곳을 가리키는 것이 아니라 똑같은 값을 가지는 메모리 공간을 확보한 후 그 공간을 식별자가 가르키도록 한다. 따라서 원본이 바뀌어도 아무런 영향을 미치지 못한다.

2. 객체

객체는 프로퍼티 개수가 정해져 있지 않고, 동적으로 추가와 삭제가 가능하기 때문에 메모리 공간의 크기를 사전에 정의할 수 없다.

이 때문에 객체는 원시값과 다른 방식으로 동작한다.

자바스크립트에서는 기본적으로 헤시테이블과 유사하게 객체를 관리한다. V8 자바스크립트 엔진에서는 프로퍼티에 접근하기 위해 동적 탐색 대신 히든 클래스 방식을 사용하여 클래스가 마치 사전에 선언된 것 처럼 동작하게 할 수 있다. 

- 변경 가능한 값

변수가 가리키는 값은 생성된 객체의 메모리 주소를 갖는다. 이 참조값을 통해 프로퍼티를 동적으로 추가, 삭제, 갱신이 가능하다.

따라서 객체 값을 변경해도 참조값이 바뀌지 않는다. 새로운 메모리 확보가 일어나지 않기 때문이다.

객체 값은 동적으로 변경할 수 있기 때문에 이러한 설계로 메모리 효율성을 증진시켰다. 하지만 이로 인한 문제점으로 여러 변수가 한 객체를 가리킬 수 있다.

> 얕은 복사와 깊은 복사
    객체를 프로퍼티 값으로 갖는 객체의 경우 얕은 복사는 한 단계만 복사하고, 깊은 복사는 객체에 중첩되어 있는 객체까지 모두 복사한다.

- 참조에 의한 전달

여러 변수가 한 객체를 가리킬 경우 객체의 변경이 모든 변수에 영향을 미친다. 여기서 값에 의한 전달과 참조에 의한 전달은 엄연히 말하면 값에 의한 전달밖에 없다. 왜냐하면 참조값을 주는지 원시값을 주는지의 차이밖에 없기 때문이다.

현재 자바스크립트 이러한 동작에 대해 공식적인 용어가 없다. 따라서 원시값을 주는 경우 값에 의한 전달, 참조값을 주는 경우 참조에 의한 전달로 부르려고 한다.


