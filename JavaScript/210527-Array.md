# 배열

1. 배열이란?

배열은 여러 개의 값을 순차적으로 나열한 자료 구조다.

배을이 가지고 있는 값을 요소라고 부른다. 배열의 요소는 배열에서 자신의 위치를 나타내는 0 이상의 정수인 인덱스(index)를 갖는다.

요소에 접근할 때는 대괄호 표기법을 사용한다. 대괄호 안에는 인덱스를 지정한다. 배열을 length 프로퍼티를 갖는다. 따라서 for문을 사용할 수 있다. 배열을 객체 타입이다.

배열은 배열 리터럴, Array 생성자 함수, Array.of, Array.from 메서드로 생성할 수 있다. 생성자 함수는 Array이며, 프로토타입 객체는 Array.prototype이다.

배열은 일반 객체와 구분되는 특징이 있다.

|구분|객체|배열|
|--|:--:|:--:|
|구조|프로퍼티 키와 프로퍼티 값|인덱스와 요소|
|값의 참조|프로퍼티 키|인덱스|
|값의 순서|x|O|
|length 프로퍼티|x|O|

배열은 임의적인 접근이 가능하다는 것이 가장 큰 장점이다.

2. 자바스크립트 배열은 배열이 아니다.

하나의 데이터 타입으로 통일되어 있으며 연속적으로 인접해 있는 것을 밀집 배열(dense array)이라 한다.

> 검색 대상 요소의 메모리주소 = 배열의 시작 메모리 주소 + 인덱스 * 요소의 바이트 수

하지만 정렬되지 않은 배열에서 특정한 요소를 검색하는 경우 모든 요소를 봐야하기 때문에 시간복잡도가 O(n)이 된다.

또한 배열에 요소의 삽입/삭제가 이루어지는 경우 요소를 이동시켜야 한다는 단점이 있다.

자바스크립트의 배열은 동일한 크기를 가지지 않으며 연속적이란 보장이 없다. 이러한 배열을 희소 배열이라 한다. 따라서 자바스크립트의 배열은 일반적인 배열의 동작을 흉내 낸 특수한 객체다.

자바스크립트 배열의 요소는 프로퍼티 값이다. 프로퍼티 값으로 모든 값이 올 수 있으므로 어떤 타입이던 배열의 요소가 될 수 있다.

따라서 자바스크립트는 인덱스로 배열 요소에 접근하는 것은 느릴 수 있지만 특정 요소를 검색하거나 삽입/삭제 하는 경우 빠른 성능을 기대할 수 있다.

모던 자바스크립트 엔진은 배열을 일반 객체와 구별하여 좀 더 배열처럼 동작하도록 최적화하여 구현했다.

3. length 프로퍼티와 희소 배열

length 프로퍼티는 요소의 개수를 나타내므로 0 이상의 정수값을 가지고 있다. length 프로퍼티의 값은 요소 추가/삭제에 따라 자동 갱신된다.

length프로퍼티 값은 명시적으로 할당할 수도 있다. 현재 length보다 작은 값을 할당하면 배열의 길이가 줄어든다. 더 큰 값을 할당하면 length자체 값을 늘어나지만 배열의 길이엔 영향을 주지 않는다.

따라서 희소 배열은 length의 실제 요소 개수보다 언제나 크다.

다만 희소 배열은 성능면에서 좋지 않고 배열의 정의에 부합하기 힘들다.

4. 배열 생성

- 배열 리터럴

0개 이상의 요소를 쉼표로 구분하여 대괄호로 묶는다. 키를 쓰지 않고 값만 적는다. 대괄호 안에 아무것도 적지 않으면 lnegth 프로퍼티 값이 0인 빈 배열이 된다.

배열 리러럴에 요소를 생략하면 희소 배열이 생성된다.

- Array 생성자 함수

Array 생성자 함수는 전달된 인수의 개수에 따라 다르게 동작한다.

+ 인수가 하나이고 숫자인 경우 length 프로퍼티 값이 인수인 배열을 생성한다. 이때 생성된 배열은 희소 배열이다.

+ 전달된 인수가 없는 경우 빈 배열을 생성한다.

+ 전달된 인수가 2개 이상이거나 숫자가 아닌 경우 인수를 요소로 갖는 배열을 생성한다.

Array 생성자 함수는 일반 함수로서 호출해도 생성자 함수로 동작한다. 왜냐하면 Array 생성자 함수 내부에서 new.target을 확인하기 때문이다.

- Array.of

ES6에서 도입된 Array.of 메서드는 전달된 인수를 요소로 갖는 배열을 생성한다.

- Array.from

ES6에서 도입되었으며 유사 배열 객체 또는 이터러블 객체를 인수로 전달받아 배열로 변환하여 반환한다.

두번째 인수로 콜백 함수를 전달하여 값을 만들면서 요소를 채울 수 있다. 첫번째 인수로 배열을 만들고 배열을 순회하며 콜백 함수의 반환값을 배열에 담아 반환한다.

> 유사 배열 객체와 이터러블 객체

유사 배열 객체는 인덱스로 프로퍼티 값에 접근할 수 있고 length 프로퍼티를 갖는 객체를 말한다. 유사 배열 객체는 마치 배열처럼 for 문으로 순회할 수 있다.

이터러블 객체는 Symbol.iterator 메서드를 구현하여 for...of문으로 순회할 수 있다. 또한 스프레드 문법과 디스트럭처링 할당의 대상으로도 사용할 수 있다. 

5. 배열 요소의 참조

배열의 요소를 참조할 때는 대괄호 표기법을 사용한다. 대괄호안엔 표현식이 올 수도 있다. 인덱스는 값을 참조한다는 의미에서 프로퍼티 키와 같은 역할을 한다.

존재하지 않은 요소에 접근하면 undefined가 반환된다.

희소배열에서도 존재하지 않는 요소를 참조해도 undefined가 반환된다.

6. 배열 요소의 추가와 갱신

배열에도 요소를 동적으로 추가할 수 있다. 존재하지 않는 인덱스를 사용해 값을 할당하면 새로운 요소가 추가된다. 이때 length프로퍼티 값은 자동 갱신된다.

배열의 length보다 더 큰 인덱스로 새로운 요소를 추가하면 희소 배열이 된다.

인덱스로 요소에 접근하여 명시적으로 값을 할당하지 않은 요소는 생성되지 않는다.

이미 요소가 존재하면 그 요소에 값을 재할당 할 수 있다.

배열에서 만약 정수 이외의 값을 인덱스처럼 생성하면 프로퍼티가 생성된다. 이때 생성된 프로퍼티는 length에 영향을 주지 않는다.

7. 배열 요소의 삭제

delete 연산자는 객체의 프로퍼티를 삭제한다. 배열에서 delete를 사용하면 희소 배열이 되며 length 프로퍼티 값은 변하지 않는다. 따라서 delete 연산자는 사용하지 않는 편이 좋다.

이를 만들지 않기 위해선 Array.prototype.splice 메서드를 사용한다.

8. 배열 메서드

배열 메서드는 원본 배열을 직접 변경하는 메서드와 원본 배열을 변경하지 않고 새로운 배열을 생성하여 반환하는 메서드가 있다.

원본 배열을 직접 변경하는 경우 부수효과가 발생할 수 있으니 가급적 원래 배열을 직접 변경하지 않는 메서드를 사용해야 한다.

- Array.isArray

Array.isArray는 생성자 함수의 정적 메서드이다. Array.of와 Array.from 생성자 함수의 정적 메서드다.

Array.isArray 메서드는 전달된 인수가 배열이면 true, 배열이 아니면 false를 반환한다.

- Array.prototype.indexOf

indexOf 메서드는 원본 배열에서 인수로 전달된 요소를 검색하여 인덱스를 반환한다.

- 원본 배열에 인수로 전달할 요소와 중복되는 요소가 여러개 있으면 첫번째 반환
- 원본 배열에 인수로 연결한 요소가 존재하지 않으면 -1 반환

indexOf 메서드 대신 ES7에서 도입된 Array.prototype.includes 메서드를 사용하면 가독성이 더 좋다.

- Array.prototype.push

push 메서드는 인수로 전달받은 모든 값을 원본 배열의 마지막 요소로 추가하고 변경된 length 프로퍼티 값을 반환한다. push 메서드는 원본 배열을 직접 변경한다.

push 메서드를 사용하지 않고 length프로퍼티를 사용하여 배열의 마지막에 요소를 직접 추가할 수 있다. 이 방법이 더 빠르다.

push 메서드는 부수 효과가 있으므로 ES6의 스프레드 문법을 사용하는 편이 좋다. 

- Array.prototype.pop

pop 메서드는 원본 배열에서 마지막 요소를 제거하고 제거한 요소를 반환한다. 원본 배열이 빈 배열이면 undefined를 반환한다. pop 메서드는 원본 배열을 직접 변경한다.

pop 메서드와 push 메서드를 이용하면 스택을 쉽게 구현할 수 있다. 

- Array.prototype.unshift

unshift 메서드는 인수로 전달받은 모든 값응ㄹ 원본 배열의 선두에 추가한다. 그리고 변경도니 length 프로퍼티 값을 반환한다. 원본 배열을 직접 변경한다.

unshift 메서드는 원본 배열을 직접 변경하는 부수 효과가 있다. 따라서 스프레드 문법을 사용하는 편이 좋다.

- Array.prototype.shift

원본 배열에서 첫 번째 요소를 제거하고 제거한 요소를 반환한다. 원본 배열이 빈 배열이면 undefined를 반환한다. shift 메서드는 원본 배열을 직접 변경한다.

shift메서드와 push메서드를 사용하면 큐를 쉽게 구현할 수 있다.

- Array.prototype.concat

인수로 전달된 값들을 원본 배열의 마지막 요소로 추가한 새로운 배열을 반환한다. 인수로 전달한 값이 배열이면 배열을 해체하여 새로운 배열의 요소로 추가한다.

- Array.prototype.splice

원본 배열의 중간에 요소를 추가하거나 제거하는 경우 splice 메서드를 사용한다. splice메서드는 3개의 매개변수가 있고 원본 배열을 직접 변경한다.

start: 원본 배열의 요소 제거를 시작할 인덱스이다. start가 -1이면 마지막 요소를 가리키고 -n이면 마지막에서 n번째 요소를 가리킨다.

deleteCount: start부터 제거할 요소의 개수이다. 0으로 설정하면 아무런 요소도 제거되지 않는다(옵션).

items: 제거한 위치에 삽입할 요소들의 목록이다(옵션). 생략할 경우 원본 배열에서 요소들을 제거하기만 한다.

배열에서 특정 요소를 제거하려면 indexOf 메서드를 통해 특정 인덱스를 취득한 다음 splice 메서드를 사용한다.

filter 메서드를 사용하여 특정 요소를 제거할 수도 있다. 다만 특정 요소가 중복된 경우 모두 제거된다.

- Array.prototype.slice

인수로 전달된 범위의 요소들을 복사하여 배열로 반환한다. 원본 배열은 변경하지 않는다. 두 개의 매개변수를 갖는다.

start: 복사를 시작할 인덱스다. 음수인 경우 배열의 끝에서의 인덱스를 나타낸다.
end: 복사를 종료할 인덱스이다. end인덱스에 해당하는 요소는 복사되지 않는다. 이 값을 명시 하지 않을 경우 length프로퍼티 값이 기본값이 된다.

인수를 모두 생력하면 원본 배열의 복사본을 생성하여 반환하고 이때 생성된 복사본은 얕은 복사를 통해 생성된다.

> 얕은 복사(shallow copy)와 깊은 복사(deep copy)
    얕은 복사는 한 단계까지만 복사하는 것을 말하고 깊은 복사는 객체에 중첩되어 있는 객체까지 모두 복사하는 것을 말한다.

slice를 통해 유사 배열 객체를 배열로 변환할 수 있다.

- Array.prototype.join

join 메서드는 원본 배열의 모든 요소를 문자열로 변환한 후 구분자로 연결된 문자열을 반환한다. 구분자의 기본값은 콤마이며 생략할 수 있다.

- Array.prototype.reverse

reverse 메서드는 원본 배열의 순서를 반대로 뒤집는다. 이때 원본 배열이 변경된다.

- Array.prototype.fill

인수로 전달받은 값을 배열의 처음부터 끝까지 요소로 채운다. 이때 원본 배열이 변경된다.

두 번째 인수로 요소 채우기를 시작할 인덱스를 전달할 수 있다.

세 번째 인수로 요소 채우기를 멈출 인덱스를 전달할 수 있다.

- Array.prototype.includes

ES7에서 도입된 includes 메서드는 배열 내에 특정 요소가 포함되어 있는지를 확인하여 true 또는 false를 반환한다. 

두 번째 인수로 검색을 시작할 인덱스를 전달할 수 있다. 생략할 경우 0을 기본값으로 가진다. 음수를 전달했을 경우 length + index부터 겁색 시작 인덱스를 설정한다.

indexOf 메서드를 사용하면 반환값이 -1인지 확인해보아야 하고 배열에 NaN이 포함되어 있는지 확인할 수 없다는 문제가 있다.

- Array.prototype.flat

ES10(ECMAScript 2019)에서 도입된 flat 메서드는 인수로 전달한 깊이만큼 재귀적으로 배열을 평탄화한다.

중첩 배열을 평탄화할 깊이를 인수로 전달할 수 있다. 기본값은 1이다. 인수로 Infinity를 전달하면 중첩 배열 모두를 평탄화한다.

9. 배열 고차 함수

고차 함수는 함수를 인수를 전달받거나 함수를 반환하는 함수를 말한다. 고차함수는 외부 상태의 변경이나 가변 데이터를 피하고 불변성을 지향하는 함수형 프로그래밍 기반이다.

함수형 프로그래밍은 순수 함수(pure function)와 보조 함수의 조합을 통해 복잡성을 해결하고 변수 사용을 억제하여 상태 변경을 피하려는 프로그래밍 패러다임이다. 결구 순수 함수를 통해 부수 효과를 최대한 억제하고자 한다.

- Array.prototype.sort

배열의 요소를 정렬한다. 원본 배열을 직접 변경하며 정렬된 배열을 반환한다. 기본적으로 오름차순으로 요소를 정렬한다.

한글 문자열인 요소도 오름차순으로 정렬된다. 내림차순으로 하고 싶은 경우 sort 메서드를 사용한 뒤 reverse 메서드를 사용한다.

sort 메서드의 기본 정렬 순서는 유니코드 코드 포인트의 순서를 따르기 때문에 숫자가 들어있는 배열을 정렬할 경우 정렬 순서를 정의하는 비교 함수를 인수로 전달해야 한다.

> sort 메서드의 정렬 알고리즘

sort 메서드는 quicksort 알고리즘을 사용했다. ECMAScripte 2019(ES10)dptjsms timsort 알고리즘을 사용하도록 바뀌었다.

- Array.prototype.forEach

forEach 메서드는 자신의 내부에서 반복문을 실행한다. 자신을 호출한 배열을 순회하면서 수행해야할 처리를 콜백 함수로 전달받아 반복 호출한다.

forEach 메서드는 콜백 함수를 호출할 때 3개의 인수 즉, 호출한 배열의 요소값과 인덱스 그리고 forEach 메서드를 호출한 배열(this)을 순차적으로 전달한다.

> 여기서 this란 forEach 메서드 내부의 this를 의미한다.

forEach 메서드는 원본배열을 변경하지 않는다. 하지만 콜백 함수를 통해 원본 배열을 변경할 수 있다.

forEach 메서드의 반환값은 언제나 undefined다.

forEach 메서드의 두 번째 인수로 forEach 메서드의 콜백 함수 내부에서 this로 사용할 객체를 전달할 수 있다.

forEach 메서드는 for문과는 달리 break, continue문을 사용할 수 없다. 또한 forEach 메서드의 콜백함수가 값을 반환해도 forEach 메서드는 콜백 함수의 반환값을 캐치하지 않는다. 언제나 undefined를 반환한다.

희소 배열의 경우 존재하지 않는 요소는 순회 대상에서 제외된다.

forEach 메서드는 for문에 비해 성능이 떨어지지만 가독성은 더 좋다.

- Array.prototype.map

map 메서드는 자신을 호출할 모든 요소를 순회하면서 인수로 전달받은 콜백 함수를 반복 호출한다. 그리고 콜백 함수의 반환값들로 구성된 새로운 배열을 반환한다.

이 때문에 forEach 메서드는 단순히 반복문을 대체하기 위한 고차 함수이고, map 메서드는 요소값을 다른 값으로 매핑한 새로운 배열을 생성하기 위한 고차함수이다.

map 메서드가 생성하여 변환하는 배열의 length 프로퍼티 값은 map 메서드를 호출한 배열의 length 프로퍼티 값과 반드시 일치한다. 즉 두 배열이 1:1 매핑한다.

forEach 메서드와 마찬가지로 map 메서드의 콜백 함수는 map 메서드를 호출한 배열의 요소값과 인덱스, 배열 자체를 순차적으로 전달받을 수 있다.

- Array.prototype.filter

filter 메서드는 콜백 함수의 반환값이 true인 요소로만 구성된 새로운 배열을 반환한다.

filter메서드가 생성하여 반환한 새로운 배열의 length프로퍼티 값은 filter 메서드를 호출한 배열의 length 프로퍼티 값과 같거나 작다.

- Array.prototype.reduce

reduce 메서드는 자신을 호출한 배열을 모든 요소를 순회하며 인수로 전달받은 콜백 함수를 반복 호출한다. 그리고 콜백 함수의 반환값을 다음 순회 시에 콜백 함수의 첫 번쨰 인수로 전달하면서 콜백 함수를 호출하여 하나의 결과값을 만든다. 원본 배열은 변경되지 않는다.

reduce 메서드는 첫 번째 인수로 콜백 함수, 두 번째 인수로 초기값을 전달받는다. 콜백 함수에는 초기값(또는 이전 반환값), reduce 메서드를 호출한 배열의 요소값과 인덱스 reduce를 호출한 배열 자체가 전달된다.

reduce에는 총 4개의 인수(accumulator, currentValue, index, array)가 전달된다.

reduce는 이 4개의 인수를 이용하여 하나의 반환값을 반환한다.

중복 요소를 제거할 때에는 Set을 사용할 수 있다. reduce 메서드의 초기값은 생략할 수 있다.

하지만 메서드 호출 시에는 초기값을 전달하는 것이 안전하다.

- Array.prototype.some

some 메서드는 자신을 호출한 배열의 요소를 순회하면서 인수로 전달된 콜백 함수를 호출한다. 이 콜백 함수 중 하나라도 함수의 정의를 만족한 경우 true, 아니면 false를 반환한다.

some 메서드의 콜백 함수는 요소값, 인덱스 some메서드를 호출한 배열 자체, 즉 this를 순차적으로 전달받을 수 있다.

하지만 화살표 함수 사용을 더 추천한다.

- Array.prototype.every

배열의 모든 요소가 콜백 함수를 통해 정의한 조건을 모두 만족하면 true, 아니면 false를 반환한다. 빈 배열인 경우 무조건 false를 반환한다.

every 메서드를 호출한 요소값과 인덱스, every 메서드를 호출한 배열 자체를 순차적으로 전달받을 수 있다.

- Array.prototype.find

ES6에서 도입된 메서드이며 콜백 함수의 반환값이 true인 첫번째 요소를 반환한다. 콜벡함수에 요소값과 인덱스 find 메서드를 호출한 배열 자체를 전달받을 수 있다.

- Array.prototype.findIndex

ES6에서 도입된 findIndex메서드는 배열의 요소를 순회하면서 콜백 함수를 호출하여 반환값이 true인 첫 번째 요소의 인덱스를 반환한다. 콜벡함수에 요소값과 인덱스 find 메서드를 호출한 배열 자체를 전달받을 수 있다.

- Array.prototype.flatMap

ES10(ECMAScript 2019)에서 도입된 flatMap 메서드는 map메서드를 통해 생성된 새로운 배열을 평탄화한다. map과 flat을 순차적으로 실행한 결과와 동일하다. 대신 1단계만 평탄화한다.



