# 스코프

1. 스코프란?

변수나 객체의 유효범위를 일컫는다. 모든 식별자는 자신이 선언된 위치에 의해 다른 코드가 식별자 자신을 참조할 수 있는 유효 범위가 결정된다. 

스코프가 다른 두 변수 중에서 식별자를 선택하는 과정을 식별자 결정이라 한다. 이때 자바스크립트는 문맥을 통해 식별자를 선택한다.

> 코드의 문맥과 환경
    코드의 실행 위치와 주변환경을 렉시컬 환경이라 한다. 이를 구현한 것이 실행 컨텍스트이다.

식별자는 한 스코프 내에서 유일한 것이다. 다만 var의 경우 같은 스코프 내에서 중복 선언이 허용된다. let이나 const 키워드로 선언된 변수는 같은 스코프 내에서 중복 선언을 허용하지 않는다.

2. 스코프의 종류

코드는 전역과 지역으로 구분할 수 있고 선언 장소에 따라 전역 스코프 또는 지역 스코프를 가진다.

- 전역과 전역 스코프

전역이란 코드의 가장 바깥 영역을 일컫는다. 전역 변수는 어디에서도 참조할 수 있다.

- 지역과 지역 스코프

지역이란 함수 내부를 말한다. 지역 스코프는 자신의 하위 스코프에서만 참조가 가능하다.

3. 스코프 체인

함수는 중첩이 가능하므로 스코프도 중첩이 가능하다. 모든 스코프는 계층적 구조로 연결되고 이 스코프의 최상위 게층은 전역 스코프이다. 이를 스코프 체인이라 한다.

변수를 참조할 때 자바스크립트는 스코프 체인을 통해 하위 스코프에서 상위 스코프까지 변수를 탐색할 수 있다. 스코프 체인은 렉시컬 환경을 통해 실체로 존재한다. 변수 식별자가 렉시컬 환경에 키로 등록되며 변수 할당이 일어나면 변수 식별자에 해당하는 값을 변경한다

> 렉시컬 환경
    스코프 체인은 실행 컨텍스트의 렉시컬 환경을 단방향으로 연결한 것이다.

- 스코프 체인에 의한 변수 검색

참조하는 스코프에서 스코프 체인을 통해 하위 스코프에서 상위스코프로 변수를 찾아가며 변수를 찾을 시 검색을 종료한다. 하위에서 상위 스코프를 참조할 수 있지만, 상위에서 하위 스코프에 있는 변수를 참조하진 못한다.

- 스코프 체인에 의한 함수 검색

변수와 동일하게 동작한다. 함수도 식별자로써 호출되기 때문이다.

4. 함수 레벨 스코프

지역 스코프는 함수로 인해서만 생성된다. 따라서 자바스크립트는 함수 레벨 스코프이다. 하지만 ES6에서 새로 추가된 let, const 키워드는 블록 레벨 스코프를 지원한다.

5. 렉시컬 스코프

자바스크립트는 렉시컬 스코프를 따르므로 함수의 정의 위치에 따라 스코프가 결정된다. 그리고 함수를 호출할 때 마다 상위 스코프를 정의한다. 